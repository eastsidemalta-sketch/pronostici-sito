# Blueprint Render - deploy con un click
# Vai su dashboard.render.com → New → Blueprint → collega il repo

services:
  # Produzione - playsignal.io
  - type: web
    name: playsignal
    runtime: node
    region: frankfurt
    plan: starter  # o free per iniziare
    branch: main
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: NODE_OPTIONS
        value: --max-old-space-size=400
      # Aggiungi nel dashboard: API_FOOTBALL_KEY, THE_ODDS_API_KEY, ADMIN_EMAIL, ADMIN_PASSWORD

  # Staging - test prima del go-live (puoi metterlo in pausa)
  - type: web
    name: playsignal-staging
    runtime: node
    region: frankfurt
    plan: free
    branch: main
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: NODE_OPTIONS
        value: --max-old-space-size=512

  # Cron job: aggiorna partite live ogni minuto
  - type: cron
    name: playsignal-live-cron
    runtime: node
    region: frankfurt
    plan: starter
    branch: main
    schedule: "*/2 * * * *"
    buildCommand: npm install
    startCommand: node scripts/render-cron.mjs
    envVars:
      - key: SITE_URL
        value: https://www.playsignal.io
      - key: CRON_SECRET
        sync: false
